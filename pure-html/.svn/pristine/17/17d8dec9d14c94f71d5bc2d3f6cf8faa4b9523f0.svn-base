<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>选择部门</title>
<link href="../../plugins/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
<style type="text/css">
	body {
		max-height: 450px;
		overflow: auto;
	}
	.select_dept_wrapper {
		margin:30px 50px;
		position: relative;
	}
	.depts-list {
		padding:0;
	}
	.depts-list li {
		position: relative;
		left: 8px;
		list-style: none;
		margin-bottom: 15px;
		padding:5px 5px 15px 100px;
		height: 85px;
		background: rgb(230,229,235);
		border:4px solid rgb(0,157,238);
		border-radius: 6px;
		cursor: pointer;
		/* overflow: auto; */
	}
	.depts-list li:last-child {
		margin-bottom: 30px;
	}
	.depts-list .mask{
		display: block;
		position: absolute;
		left: 0;
		top: 0;
		width: 0;
		height: 100%;
		background: rgb(0,157,238);
		transition: all 0.5s;
	}
	.depts-list li:hover .text {
		color: #ffffff;
	}
	.depts-list li:hover .mask{
		width: 100%;
	}
	.depts-list li:hover h2 {
		color: #ffffff;
	}
	.depts-list  .left-bar {
		display: block;
		position: absolute;
		left: -29px;
		top: 10px;
		padding: 10px 10px 10px 35px;
		width: 138px;
		height: 59px;
		font-size: 20px;
		color: rgb(0,157,238);
		background: url("./images/sort-bg.png") no-repeat;
		z-index: 10;
		background-size: 100% 59px;
	}
	.curDept .left-bar{
		color:#ffffff;
		background: url("./images/sort-bg-checked.png") no-repeat;
		background-size: 100% 59px;
	}
	.curDept .dept-index-icon {
		border:1px solid #fff;
		color:#ffffff;
	}
 	.depts-list .text {
		font-size: 16px;
		position: absolute;
		left: 130px;
		/* width: calc(100% - 59px); */
		z-index: 10;
		color: #4e4c4c;
	}
	.depts-list h2 {
		margin: 5px 0;
		font-size: 24px;
		color: #000;
	}

	.dept-index-icon {display: inline-block;vertical-align: top;width: 20px;height: 20px;line-height: 20px;border: 1px solid rgba(0,157,238,0.9);border-radius: 10px;text-align: center;/* background: rgba(0,157,238,0.9); */color: rgba(0,157,238,0.9);font-size: 12px;margin-top: 4px;}

</style>


<script type="text/javascript" src="../../plugins/jquery/jquery-1.11.2.min.js"></script>
<script src="/common/js/getrequest.js" ></script>
<script src="/product/workflow/js/common/getCook.js" ></script>
<script src="/static/core/layer/layer.js"></script>
<script type="text/javascript">

    $(document).ready(function(){
        getDepts();
    })
    function getDepts(){
        var view = "";
        $.ajax({
            type: "POST",
            url: "/user/getDepts",
            async: false,
            dataType: "json",
            success: function(data) {
                var arr = data.depts;
                // 对岗位进行从大到小排序
                arr.sort(function (n1,n2) {
                    var value1 = n1.treeId.length/4;
                    var value2 = n2.treeId.length/4;
                    return value1 - value2;
                })
                var orgName = getcookie('orgName');
				var curDeptid =  getcookie("deptid");
                var curClass = '';
                for ( var i in arr) {
                    var oDept =  arr[i];
                    var deptNm = arr[i].deptname;
                    // orgName ? deptNm+='/'+orgName : '';
                    var labelName = '';
                    // console.log(deptNm = '资金交易科室1/资金交易处/资金局')
                    var deptNmArr = [];
                    if (deptNm) {
                        deptNmArr = deptNm.split('/');
                        var department1 = deptNmArr[deptNmArr.length-1];
                        var department2 = '';
                        deptNmArr.forEach(function (dept,index) {
                            if (deptNmArr.length>1){
                                if (index==0) {
                                    department2 = dept;
                                }else if (index < deptNmArr.length-1) {
                                    department2 = department2 +'/' + dept;
                                }
							}

                        })
                        // if (oDept.treeId.length/4 == 1 ) {
                        //     labelName = '局'
						// }else if (oDept.treeId.length/4 == 2){
                        //     labelName = '部门'
						// }else if (oDept.treeId.length/4 == 3) {
                        //     labelName = '处室'
						// } else if (oDept.treeId.length/4 == 4){
                        //     labelName = '科室'
						// }
                        labelName = '岗位'
                    	// 选择当前部门
						// console.log(curDeptid,arr[i].deptid)
						if (curDeptid == arr[i].deptid ) {
                            curClass = 'curDept';
						}else{
                            curClass = '';
						}
                        // view += "<option id='"+arr[i].deptid+"'>"+arr[i].deptname+"</option>";
                        view += '<li class="dept '+ curClass +'"  data-value="'+ deptNm +'"  data-deptid="'+ arr[i].deptid +'">\n' +
                            '\t\t\t\t<span class="left-bar">'+ labelName +' <span class="dept-index-icon">'+ (parseInt(i)+ 1) +'</span>   </span>\n' +
                            '\t\t\t\t<div class="text">\n' +
                            '\t\t\t\t\t<h2>'+ department1 +'</h2>\n' +
                            '\t\t\t\t\t<span>'+ department2 +'</span>\n' +
                            '\t\t\t\t</div>\n' +
                            '\t\t\t\t<span class="mask"></span>\n' +
                            '\t\t\t</li>'
                    }

                }
            }
        });
        // $("#deptSelect").html(view);
		$('#depts-list').html(view);
    }

    function getChooseDept(){
        var json = {
            deptid:$("#deptSelect option:selected").attr("id"),
            deptnm:$("#deptSelect").val()
        };
        return json;
    }

    function getDefaultDept(){
        var arr = $("#deptSelect").children();
        var json = {
            deptid:$(arr[0]).attr("id"),
            deptnm:$(arr[0]).val()
        };
        return json;
    }
    
    
</script>
</head>
<body>
	<div class="select_dept_wrapper" >
		<!--<label>部门：</label>-->
		<!--<select id="deptSelect" style="width: 270px;display: inline-block;" class="form-control"></select>-->
		<ul  class="depts-list" id="depts-list">
		</ul>
	</div>
</body>
</html>