<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="/static/core/bootstrap/css/bootstrap.css">
	<link rel="stylesheet" href="/static/core/bootstrapvalidator/dist/css/bootstrapValidator.min.css"/>
	<meta http-equiv="Expires" content="0">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-control" content="no-cache">
	<meta http-equiv="Cache" content="no-cache">
	<title></title>
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-12">
				<form id="form" class="form-horizontal" style="margin-top: 15px;">
					<div class="form-group">
						<label class="col-sm-offset-1 col-sm-2 control-label">
							<b style="color: red;"> </b> 原名称：</label>
						<div class="col-sm-7">
							<input class="form-control" readonly="readonly"  type="text" id="oldName" name="oldName" >
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-offset-1 col-sm-2 control-label">
							<b style="color: red;">*</b> 新名称：</label>
						<div class="col-sm-7">
							<input class="form-control" maxlength="10" type="text" id="newName" name="newName" >
						</div>
					</div>
					<!--查询项输入框选择框等结束-->

					<!--查询重置等按钮-->
					<div class="form-group">
						<div class="col-sm-12" style="text-align: center">
							<button id="saveButton" type="button" class="btn btn-primary" onclick="saveDictionary()">
								保&nbsp;&nbsp;存
							</button>
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button type="button" class="btn btn-primary" onclick="closeIfram();">
								关&nbsp;&nbsp;闭
							</button>
						</div>
					</div>
					<!--查询重置等按钮 end-->
				</form>
			</div>
		</div>
	</div>
<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
<script src="/static/core/zTree_v3/js/jquery.ztree.core.js"></script>
<script src="/static/core/zTree_v3/js/jquery.ztree.excheck.js"></script>
<script src="/static/core/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/core/bootstrap-table/bootstrap-table.min.js"></script>
<script src="/static/core/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="/static/core/bootstrapvalidator/dist/js/bootstrapValidator.min.js"></script>
<script src="/static/core/layer/layer.js"></script>
<script type="text/javascript" src="/modules/dagl/xtpz/mlgl/tree/js/dictionaryTypeTree.js"></script>
<script type="text/javascript" src="/common/js/getrequest.js"></script>
<script type="text/javascript" src="/common/js/commonFunction.js"></script>
<script type="text/javascript" src="/static/js/common/displayData.js"></script>
    <script type="text/javascript" src="/modules/dagl/xtpz/mlgl/js/categoryValidator.js"></script>
<script src="/static/js/common/assistUtil.js"></script>
<!-- 音视频系统ip -->
<script type="text/javascript" src="/common/js/config.js"></script>
<script type="text/javascript">
var theRequest;
	 $(function () {
		 theRequest = GetRequest();
	   	$("#oldName").val(decodeURIComponent(theRequest.name));
	})
	function saveDictionary(){
		 var bootstrapValidator = $("#form").data('bootstrapValidator');
         //手动触发验证
         bootstrapValidator.validate();
         if (bootstrapValidator.isValid()) {
					$.ajax({
						url:"/dagl/xtpz/category/editTreeName",
						data:{id:theRequest.id,pId:theRequest.pId,name:$("#newName").val()},
						async:false,
						dataType:"JSON",
						type: "POST",
						success:function(data){
							if(data.flag==1){
								parent.typeTree.updateNode(data);
								layer.msg("修改成功！",{icon:1,time:2000},function (index) {
									closeIfram();
								})
							}else{
								layer.msg("修改失败，尝试刷新页面重新修改！",{icon:0,time:2000});
							}
						}
					})
         }
	}
	//关闭当前窗口
	function closeIfram(){
        var index=parent.layer.getFrameIndex(window.name);
        parent.layer.close(index);
	}
	

</script>
</body>
</html>