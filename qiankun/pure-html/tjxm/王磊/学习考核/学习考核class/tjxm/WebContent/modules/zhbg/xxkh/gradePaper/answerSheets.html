<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">

	<meta http-equiv="Expires" content="0">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-control" content="no-cache">
	<meta http-equiv="Cache" content="no-cache">

	<title>Document</title>
	<link rel="stylesheet" type="text/css" href="/static/core/bootstrap/css/bootstrap.css">
	<link rel="stylesheet" href="/static/core/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/core/bootstrapvalidator/dist/css/bootstrapValidator.min.css"/>
    <link rel="stylesheet" type="text/css" href="/static/font/iconfont.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="/static/core/html5/html5shiv.min.js"></script>
    <script src="/static/core/html5/respond.js"></script>
    <![endif]-->
    <link href="/static/css/common/style.css" rel="stylesheet"/>
    <link href="/static/css/common/form-public.css" rel="stylesheet"/>
    <link href="/static/core/bootstrap-table/bootstrap-table.css" rel="stylesheet"/>
</head>
<body style="height: 550px; overflow-y: hidden;">
	<div class="container-fluid">
		<input type="hidden" id="name">
		<div class="row">
			<div class="col-md-12">
	            <!--bootstrap-table表格-->
	            <table id="right_table"></table>
        	</div>
		</div>
	</div>
	<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
	<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
	<script src="/static/core/bootstrap/js/bootstrap.min.js"></script>
	<script src="/static/core/bootstrap-table/bootstrap-table.min.js"></script>
	<script src="/static/core/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
	<script src="/static/core/layer/layer.js"></script>
	<script src="/static/js/common/url.js"></script>
	<script src="/static/js/common/mylayer.js"></script>
	<script src="/static/core/laydate/laydate.js"></script>
	<script src="/static/js/common/tablelist.js"></script>
	<script type="text/javascript" src="/common/js/getrequest.js"></script>
	<script type="text/javascript">
		/* $('.item-left').unbind('click').bind('click', function(event) {
			var src = $(this).attr('for') || "/modules/zhbg/xxkh/gradePaper/markPapers.html" ;
			window.parent.$('#right').attr("src",src);
		}); */
		//定义bootatrap-table数据列
	    //    sortable：开启列排序，其他参考API
	    var right_table_col = [{
	        field: 'id'
	        , title: '序号'
	        , width: '5%'
	        , align:"center"
	        ,formatter : function(value, row, index) {
	        	var pageSize = $('#right_table').bootstrapTable('getOptions').pageSize;//通过表的#id 可以得到每页多少条
				var pageNumber = $('#right_table').bootstrapTable('getOptions').pageNumber;//通过表的#id 可以得到当前第几页
				var orderNum = pageSize * (pageNumber - 1) + index + 1;//计算序号
				return "<span recordId='"+row.id+"'>" + orderNum
				+ "</span>";//计算序号
	        }
	    }, {
	        field: 'userName'
	        , title: '姓名'
	        , width: '10%'
	        , align:"center"
	    }, {
	        field: 'candidateChushiName'
	        , title: '处室'
	        , width: '15%'
	        , align:"center"
	    }, {
	        field: 'paperSubjectiveScore'
	        , title: '主观题得分'
	        , width: '10%'
	        , sortable: true
	        , align:"center"
	        ,formatter: function (value, row, index) { 
	        	html=value;
	        	if(row.artificialMarkingState==0){
	        		html="-";
	        	}
	        	return html;
	        }
	    },
	    {
	        field: 'isSubmit'
	        , title: '是否交卷'
	        , width: '10%'
	        , sortable: true
	        , align:"center"
	        ,formatter: function (value, row, index) { 
	        	var data ="";
	        	if(row.isSubmit==0){
	        		data="否";
	        	}else{
	        		data="是";
	        	}
	        	return "<span>"+data+"</span>" ;
	        }
	    },{
	        field: 'cz'
	        , title: '操作'
	        , width: '10%'
	        , align:"center"
	         ,formatter: function (value, row, index) {  //直接定义function,return就是html代码
	        	 var html = "";
	         if(row.isSubmit==1){
	                if (row.artificialMarkingState == "0") {
	                	html += "<i title='开始评卷' class='glyphicon glyphicon-edit'style='cursor:pointer;' onclick=\'list.editFun(\"" + row.testId + "\",\""+row.paperId+"\",\""+row.userId+"\",\""+row.userName+"\")\'></i>&nbsp;&nbsp;";
	                }
	                if (row.artificialMarkingState == "1") {
	                	//var paperName = parent.getPaperName();
	                	html = "";
	                } 
	         }else{
	        	 html = "";
	         }
	            return html;
	        } 
	    }];
		var theRequest = GetRequest();
	    $(document).ready(function (e) {
	    	//var src = $(this).attr('for') || "/modules/zhbg/xxkh/gradePaper/markPapers.html" ;
	    	//window.parent.$('#right').attr("src",src);
	        //初始化表格
	        TableInit.init({
	            domId:"right_table",
	            url:"/zhbg/xxkh/testmanage/getTestPersonInfo?testId="+theRequest.testId+"&isUser=paixu"+"&"+Math.random(),
	            columns:right_table_col,
	            pagination:true,
	           	height:parent.getHeight(),
	            queryParams:function(params){
	                //这里将各个查询项添加到要传递的参数中
					//	                可以做一些校验
	                //params.xname = $('#queryDiv input[name=\'textfield2\']').val();
	                //params.xage = $('#queryDiv input[name=\'textfield2\']').val();
	                return params;
	            },
	            readOnlyFn:function(value){
	            	/* $('tr.readOnly').find('td:not(:last)').attr("title","点击查看已评卷详情");
	                $('tr.readOnly').find('td:not(:last)').unbind('click').bind('click',function(e){
						//	                    取消事件冒泡
	                    var evt = e ? e : window.event;
	                    if (evt.stopPropagation) {
	                        evt.stopPropagation();
	                    }else {
	                        evt.cancelBubble = true;
	                    }
						//	                    取消事件冒泡 end
						var resId = $('#left_ul').find('a.active').attr("id");
						MyLayer.layerOpenUrl({url:'/modules/zhbg/xxkh/gradePaper/markPapers.html',title:'查看评卷'});
	                }); */
	                //$(".fixed-table-body").css("height","80%")
	                $('tr.readOnly').find('td').css("cursor","default");
	                
	            }
	        });
	    });
	    var list = { 
	    		
	            editFun:function(testId,paperId,userId,userName){
	            	var resId = $('#left_ul').find('a.active').attr("id");
	            	// window.open('/modules/zhbg/xxkh/gradePaper/markPapers.html?testId='+testId+'&paperId='+paperId+'&userId='+userId,);
	                /*  MyLayer.layerOpenUrl({
	                    url:'/modules/zhbg/xxkh/gradePaper/markPapers.html?testId='+testId+'&paperId='+paperId+'&userId='+userId,
	                    title:userName,
	                    width: "90%", 
	                    height: "90%"
	                })  */
	                parent.parent1(testId,paperId,userId,userName);
	            },
	            deleteFun:function(id){
	            	var resId = $('#left_ul').find('a.active').attr("id");
	                MyLayer.deleteOpt({
	                    url:'/zhbg/zbgl/dutywork/delete?id='+id+'&resId='+resId,
	                    tableId:'right_table'
	                })
	            }
	        }
	    function shuaxing(){
	    	TableInit.refTable('right_table');
	    }
	</script>
	
</body>
</html>


