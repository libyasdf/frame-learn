<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    
    <title>企业中心</title>
    <link rel="stylesheet" href="/static/core/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/core/bootstrapvalidator/dist/css/bootstrapValidator.min.css"/>
    <link href="/static/css/common/style.css" rel="stylesheet"/>
    <link href="/static/css/common/form-public.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/static/core/jquery-fileupload/css/jquery.fileupload.css">
     <link rel="stylesheet" type="text/css" href="/static/font/iconfont.css">
     <!-- Bootstrap -->
    <link href="/static/core/bootstrap-table/bootstrap-table.css" rel="stylesheet"/>
   
</head>

<body class="formpage_bj">
<div class="container-fluid formpage_area" >
    <form class="form-horizontal" id="form">
            <!-- resId -->
        <input name="resId" id="resId" type="hidden" value="">
    	       <!-- 流程字段-->
		<input name="id" id="id"  type="hidden" value=""/><!-- 工作项ID -->
		<input name="ideaName" id="ideaName" type="hidden" value=""/><!-- 当前用户意见域名称 -->
		<input name="subflag" id="subflag" type="hidden" value=""/><!-- 流程状态 -->
		<input name="filetypeid" id="filetypeid" type="hidden" value=""/><!-- 流程ID -->
		<input name="workFlowId" id="workflowid" type="hidden" value=""/><!-- 流程唯一ID -->
		<input name="workitemid" id="workitemid" type="hidden" value=""/><!-- 待办工作项ID -->
		<input name="opertation" id="opertation" type="hidden" value=""/><!-- 操作方法 -->
		<input type="hidden" name="isFinish" id="isFinish" value=""/>
		<!-- 流程字段结束 -->
        <input type="hidden" id="textId"/>
        <!-- 基本信息 -->
        
        <div class="row m-t-15">
            <div class="col-md-12">
             <div class="form-group">
						<label for="" class="col-md-2 control-label"> 日期：</label>
                    <div class="col-md-4 form-view">
                        <span name="datePlan" id="datePlan" ></span>
                    </div>
						
                	</div>
            </div>
        </div>
        <!-- 基本信息结束 -->
    </form>
    <div class="row">
            <div class="col-md-12 ">
                <div class="block_title">
                    <span class="name">计划列表</span>
                </div>
            </div>
        </div>
            <div class="col-md-12">
                <table id="right_table" ></table>
            </div>
            <div class="row">
            <div class="col-md-12 ">
                <div class="block_title">
                    <span class="name">日志列表</span>
                </div>
            </div>
        </div>
            <div class="col-md-12">
                <table id="right_table2" ></table>
            </div>
</div>
   
<!-- 按钮区结束 -->
<!-- 按钮区结束 -->
<!-- 按钮区结束 -->
<script type="text/javascript" src="/static/js/common/assistUtil.js"></script>
<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
<script src="/static/core/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/core/bootstrap-table/bootstrap-table.min.js"></script>
<script src="/static/core/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="/static/core/bootstrapvalidator/dist/js/bootstrapValidator.min.js"></script>
<script src="/static/core/layer/layer.js"></script>
<script src="/static/js/common/mylayer.js"></script>
<script type="text/javascript" src="/static/js/common/assistUtil.js"></script>
<script src="/static/js/common/tablelist.js"></script>
<script src="/static/core/laydate/laydate.js"></script>
<!-- 流程相关 -->
<script type="text/javascript" src="/common/js/config.js"></script>
<script type="text/javascript" src="/product/workflow/js/storages.js"></script>
<script type="text/javascript" src="/common/js/commonFunction.js"></script>
<!-- <script type="text/javascript" src="/common/js/overlay.js"></script> -->
<!-- 获取cookie值 -->
<script type="text/javascript" src="/product/workflow/js/common/getCook.js"></script>
<!-- 页面获取参数 -->
<script type="text/javascript" src="/common/js/getrequest.js"></script>
<!-- 自定义意见(最后进行加载) -->
<script type="text/javascript" src="/common/html/notion/notion.js"></script>
<!-- 数据回显 -->
<script type="text/javascript" src="/static/js/common/displayData.js"></script>

<!--文件上传js-->
<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
<script src="/static/core/jquery-fileupload/js/vendor/jquery.ui.widget.js"></script>
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="/static/core/jquery-fileupload/js/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<script src="/static/core/jquery-fileupload/js/jquery.fileupload.js"></script>
<script src="/static/js/common/myfilupload.js"></script>
<!-- 引入自己模块功能的js -->
<script type="text/javascript" src="js/workPlanEdit.js"></script>
<!-- <script type="text/javascript" src="js/workPlanValidator.js"></script> -->
<!--文件上传js end-->
<script type="text/javascript">
    scrollTop.init();

</script>
<!--文件上传js end-->
<script type="text/javascript">
//Dictionary.init({mark:'log_type',type:'1',position:"planType",domType:"select",name:"planType"});
 $(function () {
	 var theRequest = GetRequest();
		$("#datePlan").text(theRequest.datePlan);
	if($("#datePlan").val()){
		loadData($("#datePlan").val());
	}
	
})   
     var right_table_col = [{
         title: '序号'
        , width: '5%'
        , order: "desc"
        , align:"center"
        , formatter: function (value, row, index) {
        	  var pageSize=$('#right_table').bootstrapTable('getOptions').pageSize;
              var pageNumber=$('#right_table').bootstrapTable('getOptions').pageNumber;
              var orderNum = pageSize * (pageNumber - 1) + index + 1;//计算序号
              return "<span data-id='"+row.id+"'>"+orderNum+"</span>";
           }
    }, {
        field: 'content'
        , title: '内容'
        , width: '50%'
        , align:"center"
        , formatter: function (value, row, index) {
        	if(value!=null){
        		var length = value.length
	  	   	      var val = '';
	  	   	      if(length>30){
	  	   	    	  val = value.substring(0,30)+"...";//
	  	   	      }else{
	  	   	    	  val = value;
	  	   	      }
  	   	   		return  "<span data-content='"+row.content+"'>"+val+"</span>";
        	}else{
        		return "";
        	}
        	 
        }
    }, {
        field: 'planType'
            , title: '类别'
            , width: '10%'
            , align:"center"
            , formatter: function (value, row, index) {
                    if(value=='0'){
                    	return '日常'
                    }else if(value=='1'){
                        return '业务'
                    }else if(value=='2'){
                        return '党务'
                    }else {
                        return '其他'
                    }
                    
             }
     },
     {
         field: 'remindTime'
         , title: '提醒时间'
         , width: '15%'
         , align:"center"
         /* , formatter: function (value, row, index) {
                 if(value=='0')
                 	return '未完成'
                 else 
                     return '完成'
                 
          } */
     }, 
    {
        field: 'isFinish'
        , title: '状态'
        , width: '10%'
        , align:"center"
        , formatter: function (value, row, index) {
                if(value=='0')
                	return '未完成'
                else 
                    return '完成'
                
         }
    }];
     var right_table_col2 = [{
         title: '序号'
        , width: '5%'
        , order: "desc"
        , align:"center"
        , formatter: function (value, row, index) {
        	  var pageSize=$('#right_table').bootstrapTable('getOptions').pageSize;
              var pageNumber=$('#right_table').bootstrapTable('getOptions').pageNumber;
              var orderNum = pageSize * (pageNumber - 1) + index + 1;//计算序号
              return "<span data-id='"+row.id+"'>"+orderNum+"</span>";
           }
    }, {
        field: 'content'
        , title: '内容'
        , width: '50%'
        , align:"center"
        , formatter: function (value, row, index) {
        	if(value!=null){
        		var length = value.length
	  	   	      var val = '';
	  	   	      if(length>30){
	  	   	    	  val = value.substring(0,30)+"...";//
	  	   	      }else{
	  	   	    	  val = value;
	  	   	      }
  	   	   		return  "<span data-content='"+row.content+"'>"+val+"</span>";
        	}else{
        		return "";
        	}
        	 
        }
    }, {
        field: 'planType'
            , title: '类别'
            , width: '10%'
            , align:"center"
            , formatter: function (value, row, index) {
                    if(value=='0'){
                    	return '日常'
                    }else if(value=='1'){
                        return '业务'
                    }else if(value=='2'){
                        return '党务'
                    }else {
                        return '其他'
                    }
                    
             }
     }];
     function loadData(datePlan){
    	 
     	$("input[type='checkbox']").attr("checked",true)
         //初始化表格
         TableInit.init({
             domId:"right_table",
             url:"/mypage/workplan/getlistBootHql",
             columns:right_table_col,
             queryParams:function(params){
             	 params.resId = $('#left_ul').find('a.active').attr("id");
             	 var types=[];
             	 $("input[type='checkbox']:checked").each(function(){
             		 types.push(this.value)
             	 })
             	params.dateLogYear = "";
             	params.dateLogMonth ="";
             	params.dateLogWeek = "";
             	params.dateLog = $("#datePlan").val()+" - "+$("#datePlan").val();
             	params.timeCondition ='3';
             	params.isFinish = '0';
                 params.content = "";
                 params.planType = "0,1,2,3";
                 return params;
             },
             readOnlyFn:function(){
            	 $('tr.readOnly').find('td').css("cursor","default");
             	/*  $('tr.readOnly').find('td:lt(4)').unbind('click').bind('click', function (e) {
  					//取消事件冒泡
  						var resId = $('#left_ul').find('a.active').attr("id");
 		         		 var id = $(this).parent().find("span[data-id]").attr("data-id");
 		         		 MyLayer.layerOpenUrl({url: '/modules/mypage/worklog/workLogReadOnlyForm.html?id='+id+"&oper=VIEW&resId=" + resId});
 		         		 
                  });
             	 $('tr.readOnly').find('td:eq(2)').bind('mouseover', function (e) {
             		 var txt = $(this).find("span[data-content]").attr("data-content");
 	                     $(this).attr("title","点击查看详情") 
  		         		 
                   }); */
             	  
             }
            
         });
     	
        TableInit.init({
            domId:"right_table2",
            url:"/mypage/workplan/getlistBootHql",
            columns:right_table_col2,
            queryParams:function(params){
            	 params.resId = $('#left_ul').find('a.active').attr("id");
            	 var types=[];
            	 $("input[type='checkbox']:checked").each(function(){
            		 types.push(this.value)
            	 })
            	params.dateLogYear = "";
            	params.dateLogMonth ="";
            	params.dateLogWeek = "";
            	params.dateLog = $("#datePlan").val()+" - "+$("#datePlan").val();
            	params.timeCondition ='3';
            	params.isFinish = '1';
                params.content = "";
                params.planType = "0,1,2,3";
                return params;
            },
            readOnlyFn:function(){
            	$('tr.readOnly').find('td').css("cursor","default");
            	 /* $('tr.readOnly').find('td:lt(4)').unbind('click').bind('click', function (e) {
 					//取消事件冒泡
 						var resId = $('#left_ul').find('a.active').attr("id");
		         		 var id = $(this).parent().find("span[data-id]").attr("data-id");
		         		 MyLayer.layerOpenUrl({url: '/modules/mypage/worklog/workLogReadOnlyForm.html?id='+id+"&oper=VIEW&resId=" + resId});
		         		 
                 });
            	 $('tr.readOnly').find('td:eq(2)').bind('mouseover', function (e) {
            		 var txt = $(this).find("span[data-content]").attr("data-content");
	                     $(this).attr("title","点击查看详情") 
 		         		 
                  }); */
            	  
            }
           
        });
     }
</script>
</body>
</html>
