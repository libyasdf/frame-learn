<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    
    <title></title>
    <link rel="stylesheet" type="text/css" href="/static/css/common/Loading.css">
    <link rel="stylesheet" href="/static/core/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/core/bootstrapvalidator/dist/css/bootstrapValidator.min.css"/>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="/static/core/html5/html5shiv.min.js"></script>
    <script src="/static/core/html5/respond.js"></script>
    <![endif]-->
    <link href="/static/css/common/style.css" rel="stylesheet"/>
    <link href="/static/css/common/form-public.css" rel="stylesheet"/>
    <!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
    <link rel="stylesheet" href="/static/core/jquery-fileupload/css/jquery.fileupload.css">
    <link rel="stylesheet" href="/static/font/iconfont.css">
</head>
<body class="formpage_bj">
<div class="container-fluid formpage_area">
    <form class="form-horizontal" id="form">
        <!-- resId -->
        <input name="resId" id="resId" type="hidden" value="">
        <!-- 基本信息 -->
        <div class="row">
            <div class="col-md-12 ">
                <div class="block_title">
                    <span class="name">基本信息</span>
                </div>
            </div>
        </div>
        <div class="row m-t-15">
            <div class="col-md-12">
                <div class="form-group">
                    <div class="form-group" id="url">
	                    <label class="col-md-2 control-label"><b style="color: red;">*</b> 人员树：</label>
	                    <div class="col-md-10">
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptOrUserTree">（1）getDeptOrUserTree - （异步）从某部门id开始异步加载其下面的所有人员，包括子孙部门下的人员
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="deptUserTree">（2）deptUserTree - 根据deptId和level加载部门人员树
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getUserByDeptId">（3）getUserByDeptId - 根据部门id获取该部门下的直属用户
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptAndUserById">（4）getDeptAndUserById - 根据部门id，获取该部门下的所有用户，以及上级所有部门节点（上级部门节点不展示人）
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="deptAndUserTree">（5）deptAndUserTree - 根据部门id，获取该部门下的所有用户和子部门
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptAndUserBydeptId">（6）getDeptAndUserBydeptId - 根据部门id，获取该部门下的所有用户和子部门，以及上级所有部门节点（上级部门节点不展示人）
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptAndUserTreeBylevel">（7）getDeptAndUserTreeBylevel - 从顶层节点开始，获取到某部门级别截止的部门人员；（前部门级别用户展示）
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptAndUserTreeBylevel2">（8）getDeptAndUserTreeBylevel2 - 从顶层节点开始，获取到某部门级别截止的部门人员；（前部门级别用户不展示）
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getAllTreeBylevel">（9）getAllTreeBylevel - 根据人员职务获取部门人员树
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptUserByDeptIdAndRolesNo">（10）getDeptUserByDeptIdAndRolesNo - 根据部门id和业务角色编号获取对应树
                                </label>
                            </div>
                        </div>
                        <label class="col-md-2 control-label"><b style="color: red;">*</b> 部门树：</label>
                        <div class="col-md-10">
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="deptTree">（1）deptTree - 根据deptId和level加载部门树
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptListBydeptId">（2）getDeptListBydeptId - 根据部门id，获取该部门下的直属子部门，以及上级所有部门节点
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getDeptOrUserTree">（3）getDeptOrUserTree - （异步）根据部门id，获取该部门下的所有子孙部门
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" name="url" value="getAllDeptList">（4）getAllDeptList - 根据部门id，获取该部门下的子孙部门，以及上级所有部门节点
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="asyn">
                        <label for="" class="col-md-2 control-label"><b style="color: red;">*</b> 同步/异步：</label>
                        <div class="col-md-10">
                            <label class="radio-inline">
                                <input type="radio" name="asyn" value="false">同步
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="asyn" value="true">异步
                            </label>
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="type">
                        <label for="" class="col-md-2 control-label"><b style="color: red;">*</b> 人员树/部门树：</label>
                        <div class="col-md-10">
                            <label class="radio-inline">
                                <input type="radio" name="type" value="1">人员树
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="type" value="2">部门树
                            </label>
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="deptId" >
                        <label class="col-md-2 control-label">部门id：</label>
                        <div class="col-md-10">
                            <input type="text" class="form-control" name="deptId" placeholder="只能填一个部门id">
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="level" >
                        <label class="col-md-2 control-label">部门级别：</label>
                        <div class="col-md-10">
                            <input type="text" class="form-control" name="level" placeholder="只能输入0,1,2...">
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="positionName">
                        <label class="col-md-2 control-label">职务：</label>
                        <div class="col-md-10">
                            <input type="text" class="form-control" name="positionName" placeholder="只能输入1,2,3...">
                        </div>
                    </div>
                    <div class="form-group" style="display: none" id="roleNos">
                        <label class="col-md-2 control-label">业务角色编号：</label>
                        <div class="col-md-10">
                            <input type="text" class="form-control" name="roleNos" placeholder="输入业务角色编号，多个以逗号分隔，例如：C001,C002">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-12" style="text-align: center">
                        <button type="button" class="btn btn-primary"
                                onclick="openTree()"> 生成部门/人员树
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    
</div>

<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
<script src="/static/core/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/core/layer/layer.js"></script>
<script src="/static/js/common/mylayer.js"></script>
<script type="text/javascript" src="/static/js/common/assistUtil.js"></script>
<script type="text/javascript" src="/modules/system/component/tree/js/deptUserTree.js"></script>

<!-- 获取cookie值 -->
<script type="text/javascript" src="/product/workflow/js/common/getCook.js"></script>
<!-- 页面获取参数 -->
<script type="text/javascript" src="/common/js/getrequest.js"></script>

<script type="text/javascript">

    scrollTop.init();

    $(function () {
        // 初始化参数
        var theRequest = GetRequest();
        $("#resId").val(theRequest.resId ? theRequest.resId : "");
        if (theRequest.resId) {
            $("#resId").val(theRequest.resId);
        } else {
            $("#resId").remove();
        }

        $("input[name='url']").on("change",function () {
            $("#asyn").css("display","none");
            $("#type").css("display","none");
            $("#deptId").css("display","none");
            $("#level").css("display", "none");
            $("#positionName").css("display", "none");
            $("#roleNos").css("display", "none");
            $("input:radio[name='asyn']").attr("disabled",false);
            $("input:radio[name='type']").attr("disabled",false);
            $("input:radio[name='asyn']").prop("checked",null);
            $("input:radio[name='type']").prop("checked",null);
            var url = $(this).val();
            switch (url) {
                case 'getDeptOrUserTree':
                    // asyn(异步),type,deptid
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#deptId").css("display","block");
                    $("input:radio[name='asyn'][value='true']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    break;
                case 'deptUserTree':
                    //deptid,level,asyn(同步),type(1)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#deptId").css("display","block");
                    $("#level").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='1']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'getUserByDeptId':
                case 'getDeptAndUserById':
                case 'deptAndUserTree':
                case 'getDeptAndUserBydeptId':
                    // deptId,type(1),asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#deptId").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='1']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'getDeptAndUserTreeBylevel':
                case 'getDeptAndUserTreeBylevel2':
                    // level,type(1),asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#level").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='1']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'getAllTreeBylevel':
                    // 职务,type(1),asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#positionName").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='1']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'getDeptUserByDeptIdAndRolesNo':
                    //业务角色，type(1),asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#roleNos").css("display", "block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='1']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'deptTree':
                    // deptid，level，type(2),asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#deptId").css("display","block");
                    $("#level").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='2']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                case 'getDeptListBydeptId':
                case 'getAllDeptList':
                    // deptid,type(2)，asyn(同步)
                    $("#asyn").css("display","block");
                    $("#type").css("display","block");
                    $("#deptId").css("display","block");
                    $("input:radio[name='asyn'][value='false']").prop('checked','true');
                    $("input:radio[name='type'][value='2']").prop('checked','true');
                    $("input:radio[name='asyn']").attr("disabled",true);
                    $("input:radio[name='type']").attr("disabled",true);
                    break;
                default:
                    break;
            }
        })
    });

    function openTree() {
        var url = $("input:radio[name='url']:checked").val();
        var asyn,type,deptId,level,positionName,roleNos;
        if (url) {
            switch (url) {
                case 'getDeptOrUserTree':
                    // asyn(异步),type,deptid
                    asyn = true;
                    type = $("input:radio[name='type']:checked").val();
                    deptId = $("input[name='deptId']").val();
                    break;
                case 'deptUserTree':
                    //deptid,level,asyn(同步),type(1)
                    asyn = false;
                    type = '1';
                    deptId = $("input[name='deptId']").val();
                    level = $("input[name='level']").val();
                    break;
                case 'getUserByDeptId':
                case 'getDeptAndUserById':
                case 'deptAndUserTree':
                case 'getDeptAndUserBydeptId':
                    // deptId,type(1),asyn(同步)
                    asyn = false;
                    type = '1';
                    deptId = $("input[name='deptId']").val();
                    break;
                case 'getDeptAndUserTreeBylevel':
                case 'getDeptAndUserTreeBylevel2':
                    // level,type(1),asyn(同步)
                    asyn = false;
                    type = '1';
                    level = $("input[name='level']").val();
                    break;
                case 'getAllTreeBylevel':
                    // 职务,type(1),asyn(同步)
                    asyn = false;
                    type = '1';
                    positionName = $("input[name='positionName']").val();
                    break;
                case 'getDeptUserByDeptIdAndRolesNo':
                    //业务角色编号，type(1),asyn(同步)
                    asyn = false;
                    type = '1';
                    roleNos = $("input[name='roleNos']").val();
                    break;
                case 'deptTree':
                    // deptid，level，type(2),asyn(同步)
                    asyn = false;
                    type = '2';
                    deptId = $("input[name='deptId']").val();
                    level = $("input[name='level']").val();
                    break;
                case 'getDeptListBydeptId':
                case 'getAllDeptList':
                    // deptid,type(2)，asyn(同步)
                    asyn = false;
                    type = '2';
                    deptId = $("input[name='deptId']").val();
                    break;
                default:
                    break;
            }

            url = "/system/component/tree/" + url;
            openSelectZtree({'type':type,'asyn':asyn,'deptId':deptId,'level':level,'rolesNo':roleNos,'positionName':positionName,'url':url})
        }
    }

</script>
</body>
</html>
