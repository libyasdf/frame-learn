<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">

    <title></title>
    <link rel="stylesheet" type="text/css" href="/static/css/common/Loading.css">
    <link rel="stylesheet" href="/static/core/bootstrap/css/bootstrap.min.css"/>
    <link href="/static/core/bootstrap-table/bootstrap-table.css" rel="stylesheet" />


    <link rel="stylesheet" href="/static/core/bootstrapvalidator/dist/css/bootstrapValidator.min.css"/>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="/static/core/html5/html5shiv.min.js"></script>
    <script src="/static/core/html5/respond.js"></script>
    <![endif]-->
    <link href="/static/css/common/style.css" rel="stylesheet"/>
    <link href="/static/css/common/form-public.css" rel="stylesheet"/>
    <!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
    <link rel="stylesheet" href="/static/core/jquery-fileupload/css/jquery.fileupload.css">
    <link rel="stylesheet" href="/static/font/iconfont.css">
</head>
<body class="formpage_bj">

    <div class="container-fluid formpage_area" style="margin-bottom: 140px">
        <form class="form-horizontal" id="form">
            <!-- resId -->
            <input name="resId" id="resId" type="hidden" value="">
            <input name="hjxjId" id="hjxjId" type="hidden" value="">
            <input name="orgType" id="orgType" type="hidden" value="">
            <input name="dwxtOrgId" id="dwxtOrgId" type="hidden" value="">
            <input name="isTenure" id="isTenure" type="hidden" value="0">
        <!-- 基本信息 -->
            <div class="row">
                <div class="col-md-12 ">
                    <div class="block_title">
                        <span class="name">基本信息</span>
                    </div>
                </div>
            </div>
            <div class="row m-t-15">
                    <div class="col-md-12">
                        <div class="form-group">
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 党组织编码：</label>
                                <div class="col-md-4 form-view">
                                    <span id="orgId"></span>
                                </div>
                            </div>
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 组织名称：</label>
                                <div class="col-md-4 form-view">
                                    <span id="orgName"></span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 届数：</label>
                                <div class="col-md-4 form-view">
                                    <span name="sessionNumber"></span>
                                </div>
                            </div>
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 任期年限：</label>
                                <div class="col-md-4 form-view">
                                    <span name="limitYear"></span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 换届时间：</label>
                                <div class="col-md-4 form-view">
                                    <span  name="changeTime"></span>
                                </div>
                            </div>
                            <div class="rowGroup">
                                <label for="" class="col-md-2 control-label"> 换届选举形式：</label>
                                <div class="col-md-4 form-view">
                                    <span  name="modality"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </form>
        <div class="row">
            <div class="col-md-12 ">
                <div class="block_title">
                    <span class="name">领导成员</span>
                </div>
            </div>
        </div>
        <div class="row m-t-15">
            <div class="col-md-12">
                <div class="list_button_area">
                    <button class="list_table_btn2" onclick="list.addFun()">
                        <span class="glyphicon glyphicon-plus-sign"></span> 新增
                    </button>
                    <input type="checkbox"  id="ckb" value="1"> 含本届离任领导成员
                </div>
            </div>
            <div class="col-md-12">
                <!--bootstrap-table表格-->
                <table id="right_table"></table>
                <br/>
            </div>
        </div>
        <!-- 基本信息结束 -->
    </div>



<div class="form_btn_area" style="text-align: center;">
    <button class="btn btn-primary form_btn_area_btn2"  onclick="MyLayer.closeOpen()"><span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> 关闭</button>
</div>
<!-- 按钮区结束 -->
<script src="/static/core/jquery/jquery-1.11.2.min.js"></script>
<script src="/static/core/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/core/bootstrap-table/bootstrap-table.min.js"></script>
<script src="/static/core/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="/static/core/bootstrapvalidator/dist/js/bootstrapValidator.min.js"></script>
<script src="/static/core/layer/layer.js"></script>
<script src="/static/js/common/mylayer.js"></script>
<script type="text/javascript" src="/static/js/common/assistUtil.js"></script>

<script type="text/javascript" src="/common/js/commonFunction.js"></script>

<script src="/static/core/laydate/laydate.js"></script>

<script src="/static/js/common/tablelist.js"></script>

<!-- 获取cookie值 -->
<script type="text/javascript" src="/product/workflow/js/common/getCook.js"></script>
<!-- 页面获取参数 -->
<script type="text/javascript" src="/common/js/getrequest.js"></script>

<!-- 数据回显 -->
<script type="text/javascript" src="/static/js/common/displayData.js"></script>

<script type="text/javascript" src="/modules/dwgl/dzz/hjxj/js/ldcyList.js"></script>

<!--点击折叠展开-->
<script type="text/javascript" src="/static/js/common/toggle.js"></script>
<script type="text/javascript">

    var dutiesMap = Dictionary.getNameAndCode({mark:"dwgl_duties",type:"1"});

    //定义bootatrap-table数据列
    //sortable：开启列排序，其他参考API
    var right_table_col = [{
        title: '序号'
        , width: '5%'
        , order: "desc"
        , align: "center"
        , formatter: function (value, row, index) {
            var pageSize=$('#right_table').bootstrapTable('getOptions').pageSize;//通过表的#id 可以得到每页多少条
            var pageNumber=$('#right_table').bootstrapTable('getOptions').pageNumber;//通过表的#id 可以得到当前第几页
            var orderNum = pageSize * (pageNumber - 1) + index + 1;//计算序号
            return "<span recordId='"+row.id+"'>"+orderNum+"</span>";
        }
    }, {
        field: 'leaderName'
        , title: '姓名'
        , width: '12%'
        , align: "center"
    }, {
        field: 'duties'
        , title: '党内职务名称'
        , width: '12%'
        , sortable: true
        , order: "desc"
        , align: "center"
        ,formatter:function (value,row,index) {
            return dutiesMap[value];
        }
    }, {
        field: 'tenureDate'
        , title: '任职日期'
        , width: '12%'
        , sortable: true
        , order: "desc"
        , align: "center"
    },  {
        field: 'tenureMode'
        , title: '任职方式'
        , width: '12%'
        , align: "center"
    }, {
        field: 'tenureFileCode'
        , title: '任职文件文号'
        , width: '15%'
        , align: "center"
    }, {
        field: 'isTenure'
        , title: '状态'
        , width: '10%'
        , sortable: true
        , order: "desc"
        , align: "center"
        , formatter: function (value, row, index) {
            var html = "";
            if(value){
                if(value == "0"){
                    html = '在职';
                }else{
                    html = '离任';
                }
                return html;
            }
        }
    },{
        title: '操作'
        , width: '12%'
        , align: "center"
        , formatter: function (value, row, index) {  //直接定义function,return就是html代码
            if(row.isTenure == '0'){
                var html = "";
                html += "<i title='修改' class='glyphicon glyphicon-edit' onclick=\'list.editFun(\"" + row.id + "\")\'></i>&nbsp;&nbsp;";
                html += "<i title='离任' class='glyphicon glyphicon-off' onclick=\'list.outTenure(\"" + row.id + "\")\'></i>&nbsp;&nbsp;";
                html += "<i title='删除' class='glyphicon glyphicon-trash' onclick=\'list.deleteFun(\"" + row.id + "\")\'></i>&nbsp;&nbsp;"
                return html;
            };

        }
    }];



    //表格数据项的操作
    var list = {
        addFun: function (id) {
            var resId = $("#resId").val();
            var hjxjId = $("#hjxjId").val();
            var dwxtOrgId = $("#dwxtOrgId").val();
            var orgType = $("#orgType").val();
            MyLayer.layerOpenUrl({
                url: '/modules/dwgl/dzz/hjxj/ldcyEditForm.html?resId='+resId+'&hjxjId='+hjxjId+'&dwxtOrgId='+dwxtOrgId+'&orgType='+orgType,
                title: "新增",
                height:'95%'
            })
        },
        editFun: function (id) {
            var resId = $("#resId").val();
            var hjxjId = $("#hjxjId").val();
            var dwxtOrgId = $("#dwxtOrgId").val();
            var orgType = $("#orgType").val();
            MyLayer.layerOpenUrl({
                url: '/modules/dwgl/dzz/hjxj/ldcyEditForm.html?id='+id+'&resId='+resId+'&hjxjId='+hjxjId+'&dwxtOrgId='+dwxtOrgId+'&orgType='+orgType,
                title: "修改",
                height:'95%'
            })
        },
        deleteFun: function (id) {
            var resId = $("#resId").val();
            MyLayer.deleteOpt({
                url: '/djgl/ddjs/dzz/hjxj/deleteLdcy?id=' + id + '&resId='+ resId ,
                tableId: 'right_table'
            })
        },
        /* outTenure:function (id){//直接离任
            var resId = $("#resId").val();
            layer.confirm("确定离任此领导成员吗？",{
                btn : [ '确定', '取消' ]//按钮
            },function(index) {
                $.ajax({
                    type: "get",
                    url: "/djgl/ddjs/dzz/hjxj/outTenure?id=" + id + "&resId=" + resId,
                    async: false,
                    success: function (json) {
                        layer.msg('离任成功！', {icon: 1});
                        refreshPage();
                    },
                    error: function(){
                        layer.msg('离任失败，请重试！', {icon: 2});
                    }
                });
            })
        }*/
        outTenure:function (id){
            debugger
            var resId = $("#resId").val();
            MyLayer.layerOpenUrl({
                url: '/modules/dwgl/dzz/hjxj/leaveLdcyEditForm.html?id=' + id + '&resId=' + resId,
                title: "离任信息",
                width: '90%',
                height: '65%'
            })
    }
}
    //显示人员数
    $("#ckb").off('change').on('change', function (e) {
        if($('#ckb').is(':checked')){
            $('#isTenure').val("");
        }else{
            $('#isTenure').val("0");
        }
        refreshPage();
    })
    //刷新方法
    function refreshPage(){
        TableInit.refTable("right_table");
    }

</script>
</body>
</html>
